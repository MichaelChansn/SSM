<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>留言板</title>
     <link href="../css/bootstrap.min.css" rel="stylesheet">
     <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/index.css" rel="stylesheet">
    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/common2.js"></script>
	<script src="../js/jquery.infinitescroll.min.js" type="text/javascript"></script>
</head>
<body class="index-body">
<div class="head-nav ">
    <div class="head">
        <div class="content-block" >
			#if($!{SESSION_USER_NAME})
				<div class="login" ><a href="userManager" style=" text-decoration: underline;color:red">[$!{SESSION_USER_NAME}]的个人中心</a>|<a href="../logout">退出</a></div>
			#else
				<div class="login"><a href="login">登录</a> | <a href="register">注册</a></div>
			#end
            
            <img class="img-responsive " src="../img/web_logo.png">
        </div>
    </div>
    <nav class="navbar navbar-default " role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target="#example-navbar-collapse">
                <span class="sr-only">切换导航</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class=" navbar-brand " href="javascript:void(0)"><img class="img-responsive center-block" src="../img/logo.png"></a>
        </div>
        <div class="collapse navbar-collapse navbar-centre" id="example-navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a href="../index">最新</a></li>
                <li><a href="addArticle">发帖</a></li>
                <li class="drop-divider"></li>
                <li class="dropdown">
                    <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">设置 <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="javascript:void(0)">资料修改</a></li>
                        <li class="divider"></li>
                        <li><a href="javascript:void(0)">发表的文章</a></li>
                        <li class="divider"></li>
                        <li><a href="javascript:void(0)">发表的评论</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>
</div>
<div class="panel-show " style="margin-bottom:-20px;margin-top:-10px;">
<ul class="nav nav-tabs">
   <li ><a href="userManager">Home</a></li>
   <li class="active"><a href="userPublishArticle">发表的文章</a></li>
   <li><a href="userPublishComment">发表的评论</a></li>
</ul>
</div>

<div class="panel-show ">
    <div class="panel panel-primary userArticles "style="border-bottom:none">
            <div class="panel-heading">
				<span class="user-info text-"><i class=" icon-file-alt"></i> (<span class="text-danger">$!{SESSION_USER_NAME}</span>) 发表的文章</span>
            </div>
			#foreach(${articleAndCommentNum} in ${articleAndCommentNums}) 
				<div class="userArticle">
        				<div class="articleId">
        					$!{articleAndCommentNum.article.id}
        				</div>
        				<div class="publish-article-date">
        					<span class="text-left">发表于 $!date.format('yyyy-MM-dd HH:mm:ss',$!{articleAndCommentNum.article.publishtime})</span>
        				</div>
                        #if(${articleAndCommentNum.article.pic} && ${articleAndCommentNum.article.pic.length()}>0)
                        <div class="container text-center">
                            <img src="$!{SESSION_WEB_ROOT_PATH}/user/img/$articleAndCommentNum.article.userid/articleImg/$articleAndCommentNum.article.pic" class="img-responsive center-block" alt="NO IMAGE" width="400"  >
                        </div>
            			#end
                        <div class="panel-body ">
                            <p class="text-content">
            					$!{articleAndCommentNum.article.content}
                            </p>
                        </div>
                        <div class="panel-footer">
                            <span class=" text-info" ><i class="icon-thumbs-up"></i>点赞数($!{articleAndCommentNum.article.up})</span></span> 
                            <a class=" text-danger" href="javascript:articleComment($!{articleAndCommentNum.article.id});"><i class=" icon-edit"></i>评论<span class="$!{articleAndCommentNum.article.id}commentNum">($!{articleAndCommentNum.commentNum})</span></a>
                        </div>
            			<div  class="$!{articleAndCommentNum.article.id}comment comment-hide comments">
                        </div>
						<div style="margin:0px -1px 0px -1px;border-bottom:20px solid rgb(255,228,196);"></div>
				</div>
				#end 
    </div> 
</div>
<div class="panel-loading ">
    <div class="panel panel-primary">
        <div class="panel-body text-center">
    			<div class="loading">
    				<img src="../img/loading.gif"><span>正在加载...</span>
    			</div>
        </div>
    </div>
</div>
<div id="navigation"><a href="userPublishArticle?page=1"></a></div>
<script type="text/javascript">
$(document).ready(function() {

            $('.userArticles').infinitescroll({
                navSelector: "#navigation", //导航的选择器，会被隐藏
                nextSelector: "#navigation a", //包含下一页链接的选择器
                itemSelector: ".userArticle", //你将要取回的选项(内容块)
                debug: true, //启用调试信息
                animate: false, //当有新数据加载进来的时候，页面是否有动画效果，默认没有
                extraScrollPx: 150, //滚动条距离底部多少像素的时候开始加载，默认150
                bufferPx: 40, //载入信息的显示时间，时间越大，载入信息显示时间越短
                errorCallback: function() {
                    $(".loading").html("<span>没有数据了。。。</span>");
                }, //当出错的时候，比如404页面的时候执行的函数
                localMode: true, //是否允许载入具有相同函数的页面，默认为false
                dataType: 'html',//可以是json
                loading: {
                    msgText: "加载中...",
                    finishedMsg: '没有新数据了...',
                    selector: '.loading' // 显示loading信息的div
                }
            }, function(newElems) {
                //程序执行完的回调函数
                var $newElems = $(newElems);
                $('.userArticles').append($newElems);
            });

        });

    </script>
</body>
</html>